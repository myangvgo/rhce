# Chapter 6 - 用户和组管理

[返回](../README.md)

[TOC]

## 1. 用户

用户账户构成了系统安全的基础。

* 系统中的每个进程（应用程序）都作为一个特定用户运行。
* 每个文件都有一个特定用户作为其所有者。

用户账户有三种主要类型

* 超级用户：root, uid 为0， 对系统具有完全的访问权限

* 系统用户：供服务进程使用。

* 普通用户：对系统具有有限的访问权限。uid 范围 1000 - 60000

  ```sh
  cat /etc/login.defs 
       44 #
       45 # Min/max values for automatic uid selection in useradd
       46 #
       47 UID_MIN                  1000
       48 UID_MAX                 60000
       49 # System accounts
       50 SYS_UID_MIN               201
       51 SYS_UID_MAX               999
  
  ```

### 用户和密码文件

* 系统使用 `/etc/passwd` 文件存储本地用户的信息，每一行存储一个用户信息
* 系统使用`/etc/shadow` 文件存储用户的密码信息

#### `grep getent` 查看用户和密码信息

```sh
# 查看用户 sadmin 的账户信息
[sadmin@server1 ~]$ grep sadmin /etc/passwd
sadmin:x:1000:1000:sadmin:/home/sadmin:/bin/bash
[sadmin@server1 ~]$ getent passwd sadmin
sadmin:x:1000:1000:sadmin:/home/sadmin:/bin/bash

# 查看用户 sadmin 的密码信息
[root@server1 ~]# grep sadmin /etc/shadow
sadmin:...t/::0:99999:7:::
[root@server1 ~]# getent shadow sadmin 
sadmin:...t/::0:99999:7:::

# 密码的加密算法
[root@server1 ~]# passwd -S sadmin
sadmin PS 1969-12-31 0 99999 7 -1 (密码已设置，使用 SHA512 算法。)

```

#### 用户信息格式

每一行用户信息都是以七个冒号分隔的字段

`sadmin:x:1000:1000:sadmin:/home/sadmin:/bin/bash`

* `sadmin` 用户的用户名
* `x` 用户的密码曾经以加密格式存储于此处，现在存储于 /etc/shadow，该字段始终为 x
* `1000` 该用户账户的 UID
* `1000` 该用户账户的 GID
* `sadmin` 用户的真实姓名
* `/home/sadmin` 用户的家目录，是Shell启动时的初始工作目录，包含用户数据和配置设置
* `/bin/bash` 用户默认的 Shell 程序。如果用户不允许进行交互式登录，可能使用`/sbin/nologin`



## 2. 组

一个用户必须隶属于一个组，不能独立于组而存在。组用于向一组文件授予文件访问权限。

组有组名称以及组ID或GID来区分不同的组。

系统使用 `/etc/group` 文件存储有关本地组的信息。每个组条目被分为以四个冒号分隔的字段。

```sh
[root@server1 ~]# grep sadmin /etc/group
sadmin:x:1000:
```

* `sadmin` 组的名称
* `x` 过时的组密码字段，始终为 `x`
* `1000` 该组的 GID 号
* 作为补充组的该组成员的用户列表。



## 3. 组管理